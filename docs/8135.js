(self.webpackJsonpbashscript=self.webpackJsonpbashscript||[]).push([[8135],{78352:(e,t,n)=>{"use strict";n.r(t),n.d(t,{transpileText:()=>I});var r=n(55423);n(10015);const s=(e,t,n=!1,r=!1)=>n||e.length>=t.length?e.reduce((e,n,s)=>s<t.length?[...e,...r?[t[s],n]:[n,t[s]]]:[...e,n],[]):s(t,e,!0,!0),i={STRING:[],INTEGER:["i"],ARRAY:["a"],ASSOCIATIVE_ARRAY:["A"]};function o({identifier:e,valueType:t="STRING"},n){const r=i[t];return`local ${r.length>0?`-${r.join("")} `:""}${p(e)}="\${${n}}"`}const a=String.fromCodePoint(92)+"'";const l={ArrayLiteral:function({elements:e}){return`(${e.map(e=>p(e)).join(" ")})`},AssignmentExpression:function({identifier:e,operator:t,value:n}){let r=`${p(e)}${t}`;return n&&(r+=p(n)),r},CallExpression:function({callee:e,args:t}){let n=p(e);return t.length>0&&(n+=" "+t.map(e=>p(e)).join(" ")),n},CallReference:function({expression:e,quoted:t}){const n=`$(${p(e)})`;return t?`"${n}"`:n},File:function({statements:e}){return e.map(e=>p(e)).join("\n")},FunctionDeclaration:function({name:e,parameters:t,statements:n},r=0){let s=`function ${p(e)} {\n`;const i=r+2,a=" ".repeat(i);return t.length>0&&(s+=t.map((e,t)=>a+o(e,t)).join("\n"),s+="\n"),s+=n.map(e=>a+p(e,i)).join("\n"),s+="\n}",s},FunctionIdentifier:function({name:e}){return e},Parameter:o,StringLiteral:function e({style:t,value:n,type:r}){switch(t){case"SINGLE_QUOTED":return`'${n.replace(/'/g,`'${a}'`)}'`;case"UNQUOTED":return n.replace(/[^a-zA-Z0-9-_./]/g,e=>"\\"+e);default:return n.includes("\n")?e({type:r,value:n,style:"HEREDOC"}):n.match(/[^a-zA-Z0-9-_./]/)?n.includes("'")?e({type:r,value:n,style:"DOUBLE_QUOTED"}):e({type:r,value:n,style:"SINGLE_QUOTED"}):e({type:r,value:n,style:"UNQUOTED"})}},NumericLiteral:function({value:e}){return e},TemplateElement:function({value:e}){return e},TemplateLiteral:function({expressions:e,quasis:t}){const n=e.map(e=>p({...e,quoted:!1})),r=t.map(e=>p(e));return`"${s(r,n).join("")}"`},VariableDeclaration:function({identifier:e,initializer:t}){let n="declare ";return"NumericLiteral"===(null==t?void 0:t.type)&&(n+="-i "),"ArrayLiteral"===(null==t?void 0:t.type)&&(n+="-a "),n+=p(e),t&&(n+="="+p(t)),n},VariableIdentifier:function({name:e}){return e},VariableReference:function({identifier:e,bang:t,quoted:n}){const r=`\${${t?"!":""}${p(e)}}`;return n?`"${r}"`:r},UnsupportedSyntax:function(e){return""}};function p(e,t=0){return(0,l[e.type])(e,t)}function u(e,t=[]){return function(e){return Object.values(e).flatMap(e=>Array.isArray(e)?e:[e]).filter(e=>"object"==typeof e&&"type"in e)}(e).flatMap(e=>[e,...u(e,t).filter(e=>!t.includes(e.type))])}const c=(e,t=[])=>({type:"CallExpression",callee:{type:"FunctionIdentifier",name:e},args:t}),d=e=>e.replace(/[^a-zA-Z_][^a-zA-Z_0-9]*/g,"_");var m=n(76145);class y{constructor({parentScope:e,name:t,type:n}){this.byTSName=new Map,this.byBashName=new Map,this.anonymousId=0,this.parentScope=null!=e?e:this,this.name=t,this.type=n}get path(){return this.isRoot?[this.name]:[...this.parentScope.path,this.name]}get fullName(){return this.path.join(".")}getNextAnonymousId(){return"anonymous."+ ++this.anonymousId}get isRoot(){return this.parentScope===this}get(e,{skipRoot:t=!1,keyType:n="byTSName"}={}){var r;return t&&this.isRoot?void 0:null!==(r=this[n].get(e))&&void 0!==r?r:this.isRoot?void 0:this.parentScope.get(e,{skipRoot:t,keyType:n})}has(e,{skipRoot:t=!1,keyType:n="byTSName"}={}){var r;return(!t||!this.isRoot)&&(null!==(r=this[n].has(e))&&void 0!==r?r:this.isRoot?void 0:this.parentScope.has(e,{skipRoot:t,keyType:n}))}populate(e){const t=[];return e.forEach(e=>{const n=this.get(e.name);n&&t.push({type:"IdentifierShadowing",message:`The identifier ${e.name} (${e.lookupKind}) is shadowing another element (${n.lookupKind})`});const r="FUNCTION"===this.type&&"FUNCTION"===e.lookupKind?{...e,bashName:`${this.name}.${e.bashName}`}:e;this.byTSName.set(r.name,r),this.byBashName.set(r.bashName,r)}),{warnings:t}}}const f=Object.fromEntries(Object.entries(r.SyntaxKind).reduce((e,[t,n])=>{var r,s;return"number"==typeof n&&n>(null!==(s=null===(r=e[e.length-1])||void 0===r?void 0:r[0])&&void 0!==s?s:-1)?[...e,[n,t]]:e},[])),h=({tsNodes:e,scope:t,visitorOverrides:n={}})=>{const{scopeInfo:r=[],resultResolvers:s=[]}=e.reduce((e,r)=>{var s,i;const{scopeInfo:o=[],result:a}=g({node:r,scope:t,visitorOverrides:n});return{scopeInfo:[...null!==(s=e.scopeInfo)&&void 0!==s?s:[],...o],resultResolvers:[...null!==(i=e.resultResolvers)&&void 0!==i?i:[],a]}},{}),{warnings:i}=t.populate(r);return s.map(e=>"function"==typeof e?e(t):e).reduce((e,{errors:t=[],nodes:n=[],warnings:r=[]})=>{var s,i,o;return{errors:[...null!==(s=e.errors)&&void 0!==s?s:[],...t],warnings:[...null!==(i=e.warnings)&&void 0!==i?i:[],...r],nodes:[...null!==(o=e.nodes)&&void 0!==o?o:[],...n]}},{warnings:i})},v={SourceFile:(e,t,n)=>{const{nodes:r,errors:s}=h({tsNodes:e.statements,scope:t,visitorOverrides:n});return{result:{nodes:[{type:"File",statements:r}],errors:s}}},ImportDeclaration:(e,t)=>{const n=[],s=[],{importClause:i,moduleSpecifier:o}=e,a=o.text;if(i){const{name:e,namedBindings:o}=i;if(e&&s.push({type:"UnsupportedSyntax",message:"Default imports are not supported"}),o)if(o.kind===r.SyntaxKind.NamespaceImport)s.push({type:"UnsupportedSyntax",message:"Namespace imports are not supported"});else{const{elements:e}=o;e.forEach(e=>{e.propertyName&&s.push({type:"UnsupportedSyntax",message:"Importing 'as' is not supported"});const r=e.name.text;n.push({importedFrom:a,name:r,lookupKind:"IMPORTED_FUNCTION",bashName:r,scopeName:t.name})})}}return{result:{errors:s,nodes:[]},scopeInfo:n}},ExpressionStatement:(e,t,n)=>g({node:e.expression,scope:t,visitorOverrides:n}),ReturnStatement:(e,t,n)=>{const{expression:r}=e;return r?g({node:r,scope:t,visitorOverrides:n}):{result:{nodes:[c("return")]}}},CallExpression:(e,t,n)=>{const{expression:s,arguments:i}=e;if(s.kind!==r.SyntaxKind.Identifier)return{result:{errors:[{type:"UnsupportedSyntax",message:`The call must be invoked on an Identifier, but it was a ${f[s.kind]}.`}]}};const o=s.text;return{result:e=>{var t;const r=null!==(t=e.get(o))&&void 0!==t?t:{name:o,lookupKind:"FUNCTION",scopeName:"Global"},{nodes:s=[],errors:a=[]}=h({tsNodes:i,scope:e,visitorOverrides:n});if("IMPORTED_FUNCTION"===r.lookupKind){return{nodes:[{type:"CallExpression",callee:{type:"FunctionIdentifier",name:"@fromModule"},args:[{type:"StringLiteral",value:r.importedFrom},{type:"StringLiteral",value:r.name},...s]}],errors:a}}if("FUNCTION"===r.lookupKind){return{nodes:[{type:"CallExpression",callee:{type:"FunctionIdentifier",name:r.name},args:[...s]}],errors:a}}if("VARIABLE"===r.lookupKind){return{nodes:[{type:"CallExpression",callee:{type:"FunctionIdentifier",name:"@callVar"},args:[{type:"StringLiteral",value:r.name},...s]}],errors:a}}return{}}}},StringLiteral:e=>({result:{nodes:[{type:"StringLiteral",value:e.text}]}}),NumericLiteral:e=>({result:{nodes:[{type:"NumericLiteral",value:e.text}]}}),VariableStatement:(e,t,n)=>{const{declarationList:r}=e;return{result:h({tsNodes:r.declarations,scope:t,visitorOverrides:n})}},VariableDeclaration:(e,t,n)=>{const{name:s,initializer:i}=e;if(i&&"ArrowFunction"===f[i.kind])return v.FunctionDeclaration({...i,name:s},t,n);const{nodes:o=[],errors:a=[]}=i?h({tsNodes:[i],scope:t,visitorOverrides:n}):{},l=[...a];o.length>1&&l.push({type:"UnsupportedSyntax",message:"Initializer contained more than 1 node, which is not supported yet: "+o.map(e=>e.type).join(", ")});let[p]=o;if("CallExpression"===(null==p?void 0:p.type)&&(p={type:"CallReference",quoted:!0,expression:p}),s.kind!==r.SyntaxKind.Identifier)return l.push({type:"UnsupportedSyntax",message:"Identifier is an unsupported kind: "+f[s.kind]}),{result:{errors:l}};const{text:u}=s;return{result:{nodes:[{type:"VariableDeclaration",identifier:{type:"VariableIdentifier",name:u},initializer:p}],errors:l},scopeInfo:[{name:u,lookupKind:"VARIABLE",scopeName:t.name,bashName:d(u)}]}},ArrowFunction:(e,t,n)=>v.FunctionDeclaration({...e,name:{text:t.getNextAnonymousId()}},t,n),FunctionDeclaration:(e,t,n)=>{const{name:r,body:s,parameters:i}=e,o=[];if(r||o.push({type:"IncompleteSyntax",message:"Missing name for: "+f[e.kind]}),s||o.push({type:"IncompleteSyntax",message:"Missing body for: "+f[e.kind]}),!r||!s)return{result:{errors:o}};const a=r.text,l=(e=>e.replace(/^[^a-zA-Z_]/g,"_"))(a),p=new y({parentScope:t,name:l,type:"FUNCTION"});return{result:()=>{var e,t,r,o;const l=h({tsNodes:i,scope:p,visitorOverrides:n}),c=h({tsNodes:s.statements,scope:p,visitorOverrides:n}),d=(0,m.Z)(({name:e})=>e),{nodes:y,statements:f}=(null!==(e=c.nodes)&&void 0!==e?e:[]).reduce(({statements:e,nodes:t},n)=>{if("FunctionDeclaration"!==n.type)return{statements:[...e,n],nodes:t};const r=n.name.name,s=p.get(r,{keyType:"byBashName"}).bashName,i=u(n),o=d(i.filter(e=>("VariableIdentifier"===e.type||"FunctionIdentifier"===e.type)&&p.has(e.name,{skipRoot:!0,keyType:"byBashName"})&&e.name!==s));return{nodes:[...t,{...n,name:{...n.name,name:s},statements:[...o.map((e,t)=>({type:"CallExpression",callee:{type:"FunctionIdentifier",name:"eval"},args:[{type:"VariableReference",quoted:!0,identifier:{type:"VariableIdentifier",name:String(t+1)}}]})),...o.map(()=>({type:"CallExpression",callee:{type:"FunctionIdentifier",name:"shift"},args:[]})),...n.statements]}],statements:[...e,{type:"VariableDeclaration",identifier:{type:"VariableIdentifier",name:"__declaration"},initializer:{type:"ArrayLiteral",elements:[{type:"StringLiteral",value:"function"},{type:"StringLiteral",value:s},...o.map(e=>({type:"CallReference",quoted:!0,expression:{type:"CallExpression",callee:{type:"FunctionIdentifier",name:"declare"},args:[{type:"StringLiteral",value:"-p"},{type:"StringLiteral",value:e.name}]}}))]}}]}},{statements:[],nodes:[]});return{nodes:[{type:"FunctionDeclaration",name:{type:"FunctionIdentifier",name:p.get(a).bashName},parameters:null!==(t=l.nodes)&&void 0!==t?t:[],statements:f},...y],errors:[...null!==(r=l.errors)&&void 0!==r?r:[],...null!==(o=c.errors)&&void 0!==o?o:[]]}},scopeInfo:[{scopeName:t.name,name:a,lookupKind:"FUNCTION",bashName:l}]}},Identifier:(e,t)=>({result:t=>{const n=t.get(e.text);return n?{nodes:["VARIABLE"===n.lookupKind?{type:"VariableReference",quoted:!0,identifier:{type:"VariableIdentifier",name:n.bashName}}:{type:"FunctionIdentifier",name:n.bashName}]}:{errors:[{type:"ReferenceError",message:`Unable to find '${e.text}' in scope.`}]}}})};function g({node:e,scope:t,visitorOverrides:n={}}){var r;const s=f[e.kind],i=null!==(r=n[s])&&void 0!==r?r:v[s];return i?i(e,t):function(e){return{result:{errors:[{type:"UnsupportedSyntax",message:`Visitor for ${f[e.kind]} is not supported yet`}]},scopeInfo:[]}}(e)}function N(e,t="default.ts"){return function(e){const{nodes:[t]=[],errors:n,warnings:r}=h({tsNodes:[e],scope:new y({type:"FILE",name:e.fileName})}),s=p(t);return console.log(n),console.log(r),s}(r.createSourceFile(t,e,r.ScriptTarget.ESNext,!0,r.ScriptKind.TS))}const I=e=>{try{return N(e)}catch(e){return}}},13411:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=13411,e.exports=t},99235:()=>{},32574:()=>{},12993:()=>{},80905:()=>{},94219:()=>{},80004:()=>{},61758:()=>{}}]);
//# sourceMappingURL=8135.js.map